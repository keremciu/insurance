(this.webpackJsonpinsurance=this.webpackJsonpinsurance||[]).push([[0],{192:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),i=n(33),o=n.n(i),s=n(13),l=n(194),u=(n(87),n(2)),j=n(81);var d=function(){var e=Object(u.h)();return Object(r.jsx)("button",{onClick:function(){e("".concat("/insurance","/wizard"))},type:"button",children:"Start"})},b=n(82),p=n(11),h=n.n(p),O=n(24),m=n(48),f=n(4),x=n(15),v=n(193);var y=function(e){var t=e.error;return Object(r.jsxs)("div",{role:"alert",children:[Object(r.jsx)("p",{children:"Something went wrong:"}),Object(r.jsx)("pre",{style:{color:"red"},children:t.message})]})},g=n(16),S=["firstName","address","children","numberOfChildren","occupation","email"],w={firstName:{initialValue:"",placeholder:"Jane Doe",label:"What is your first name?"},address:{initialValue:"",placeholder:"Address",label:"What is your address?"},children:{initialValue:"false",label:"Do you have any children?",type:"radio",options:[{label:"Yes",value:"true"},{label:"No",value:"false"}],rejectionStep:"occupation"},numberOfChildren:{initialValue:0,type:"number",label:"How many children you have?"},occupation:{initialValue:"",label:"What is your occupation?",type:"radio",options:[{label:"Employed",value:"EMPLOYED"},{label:"Self employed",value:"SELF_EMPLOYED"},{label:"Student",value:"STUDENT"}]},email:{initialValue:"",placeholder:"johndoe@gmail.com",label:"What is your email address?"}},E="This field is required.",k=g.b().shape({firstName:g.c().min(2,"Too Short!").max(50,"Too Long!").required(E),address:g.c().min(2,"Too Short!").max(100,"Too Long!").required(E),numberOfChildren:g.a().required(E),occupation:g.c().oneOf(Object.values(["EMPLOYED","SELF_EMPLOYED","STUDENT"])).required(E),email:g.c().email("Invalid email").required(E)});function C(e){var t=e.errors,n=e.lastStep,r=Object(u.h)();return Object(a.useEffect)((function(){var e=Object.keys(t);if(!t[n]&&e.length>0){var a=Object(f.a)(e,1)[0];r("".concat("/insurance","/wizard/").concat(a))}}),[n,t,r]),null}var L=function(){var e=Object(a.useState)(!1),t=Object(f.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(null),o=Object(f.a)(i,2),s=o[0],l=o[1],j=Object(v.a)(["Authorization"]),d=Object(f.a)(j,2)[1],p=Object(u.h)(),g=Object(u.g)(),E=/[^/]*$/.exec(g.pathname)[0],L=w[E],T=void 0===L;if(Object(a.useEffect)((function(){T&&p("".concat("/insurance","/wizard/").concat(S[0]),{replace:!0})}),[T,p]),T)return null;var N=JSON.parse(localStorage.getItem("user_input"))||{},F=S.findIndex((function(e){return e===E})),z=F===S.length-1;function D(e,t){localStorage.setItem("user_input",JSON.stringify(Object(m.a)(Object(m.a)({},N),{},{step:e[t]})))}function V(){return(V=Object(O.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:if(!e.sent[E]){e.next=5;break}return e.abrupt("return",null);case 5:if(D(n,E),!L.rejectionStep||"false"!==n[E]){e.next=8;break}return e.abrupt("return",p("".concat("/insurance","/wizard/").concat(L.rejectionStep)));case 8:return r=F+1,e.abrupt("return",p("".concat("/insurance","/wizard/").concat(S[r])));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(O.a)(h.a.mark((function e(t,n){var r,a,i,o,s,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.setFieldError,c(!0),D(t,E),t.children,a=Object(b.a)(t,["children"]),e.prev=4,i=new URL("user","https://challenge-dot-popsure-204813.appspot.com"),o={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)},e.next=9,fetch(i,o);case 9:return s=e.sent,e.next=12,s.json();case 12:u=e.sent,s.ok?(d("Authorization","Bearer ".concat(u.jwt),{path:"/"}),p("".concat("/insurance","/recommendation"))):422===s.status?Object.entries(u.errors).forEach((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];r(n,a.join(", "))})):l(u.error),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),console.log(e.t0);case 19:return e.prev=19,c(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})))).apply(this,arguments)}var I=S.reduce((function(e,t){return e[t]=N[t]||w[t].initialValue,e}),{});return Object(r.jsx)(x.c,{initialValues:I,validationSchema:k,onSubmit:function(e,t){return A.apply(this,arguments)},children:function(e){var t=e.validateForm,a=e.isSubmitting,c=e.values,i=e.errors;return Object(r.jsxs)(x.b,{children:[n&&"Validating your data...",s&&Object(r.jsx)(y,{error:s}),Object(r.jsx)(u.a,{}),z?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("button",{disabled:a||n,type:"submit",children:"Submit"}),Object(r.jsx)(C,{errors:i,lastStep:E})]}):Object(r.jsx)("button",{type:"button",disabled:i[E],onClick:function(){return function(e,t){return V.apply(this,arguments)}(t,c)},children:"Next"})]})}})};var T=function(){var e=Object(x.d)().errors,t=Object(u.i)().step,n=w[t];return Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:t,children:n.label}),"radio"===n.type?Object(r.jsx)("div",{className:"radioGroup",role:"group","aria-labelledby":"my-radio-group",children:n.options.map((function(e){return Object(r.jsxs)("label",{children:[Object(r.jsx)(x.a,{type:"radio",name:t,value:e.value}),e.label]},e.value)}))}):Object(r.jsx)(x.a,{type:n.type||"text",id:t,name:t,placeholder:n.placeholder}),e[t]&&Object(r.jsx)("div",{className:"errorText",children:e[t]})]})};var N=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(null),o=Object(f.a)(i,2),s=o[0],l=o[1],j=Object(a.useState)(!1),d=Object(f.a)(j,2),b=d[0],p=d[1],m=Object(v.a)(["Authorization"]),x=Object(f.a)(m,1)[0],g=Object(u.h)();Object(a.useEffect)((function(){(function(){var e=Object(O.a)(h.a.mark((function e(){var t,n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,t=new URL("recommendation","https://challenge-dot-popsure-204813.appspot.com"),n={headers:{"Content-Type":"application/json",Authorization:x.Authorization}},e.next=6,fetch(t,n);case 6:return r=e.sent,e.next=9,r.json();case 9:a=e.sent,r.ok?c(a):l(a.error),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:return e.prev=16,p(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})));return function(){return e.apply(this,arguments)}})()()}),[x.Authorization]);var S=n.map((function(e){var t,n=e.price.amount.toFixed(2),a="\u20ac".concat(n," per ").concat(e.price.periodicity.toLowerCase());return Object(r.jsxs)("li",{children:[Object(r.jsx)("h3",{children:(t=e.type,t.toLowerCase().split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "))}),Object(r.jsx)("strong",{children:a})]},e.type)}));return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"We got your recommendation"}),Object(r.jsx)("p",{children:"Based on your answers, this is what make sense for you and what you should pay."}),b&&"Loading best recommendations for you...",s?Object(r.jsx)(y,{error:s}):Object(r.jsx)("ul",{className:"itemList",children:S}),Object(r.jsx)("button",{type:"button",onClick:function(){localStorage.removeItem("user_input"),g("".concat("/insurance","/"))},children:"Try again"})]})};var F=function(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("header",{children:Object(r.jsxs)("div",{className:"layoutContainer",children:[Object(r.jsx)("h1",{children:"Brand new insurance experience"}),Object(r.jsx)("p",{children:"Let's get you a recommendation in seconds!"})]})}),Object(r.jsx)("section",{children:Object(r.jsx)("div",{className:"layoutContainer",children:Object(r.jsx)(j.ErrorBoundary,{FallbackComponent:y,children:Object(r.jsxs)(u.d,{basename:"/insurance",children:[Object(r.jsx)(u.b,{path:"/",element:Object(r.jsx)(d,{})}),Object(r.jsx)(u.b,{path:"wizard",element:Object(r.jsx)(L,{}),children:Object(r.jsx)(u.b,{path:":step",element:Object(r.jsx)(T,{})})}),Object(r.jsx)(u.b,{path:"recommendation",element:Object(r.jsx)(N,{})})]})})})})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,195)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(s.a,{children:Object(r.jsx)(l.a,{children:Object(r.jsx)(F,{})})})}),document.getElementById("root")),z()},87:function(e,t,n){}},[[192,1,2]]]);
//# sourceMappingURL=main.a6ad9ddb.chunk.js.map